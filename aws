<!DOCTYPE html>
<html lang="en">
<head>
 <meta charset="UTF-8" />
 <meta name="viewport" content="width=device-width, initial-scale=1.0" />
 <title>Login / Signup</title>
 <style>
 body {
 font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
 background: #f4f7fa;
 margin: 0;
 display: flex;
 justify-content: center;
 align-items: center;
 height: 100vh;
 }
 .container {
 background: white;
 width: 350px;
 padding: 30px;
border-radius: 16px;
 box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
 text-align: center;
 }
 h2 {
 margin-bottom: 20px;
 }
 input {
 width: 90%;
 padding: 10px;
 margin: 8px 0;
 border: 1px solid #ddd;
 border-radius: 8px;
 font-size: 14px;
 }
 button {
 width: 95%;
 padding: 10px;
 background-color: #0066ff;
 color: white;
 border: none;
 border-radius: 8px;
 cursor: pointer;
 font-size: 15px;
 margin-top: 10px;
 }
 button:hover {
 background-color: #0052cc;
 }
 .toggle {
 color: #0066ff;
 cursor: pointer;
 margin-top: 10px;
 font-size: 14px;
 display: inline-block;
 }
 .message {
 color: red;
 margin-top: 10px;
 font-size: 14px;
 }
 </style>
</head>
<body>
 <div class="container">
 <h2 id="form-title">Login</h2>
 <input type="text" id="username" placeholder="Username (for login or signup)" />
 <input type="email" id="email" placeholder="Email (for signup only)" style="display: none;" />
 <input type="password" id="password" placeholder="Password" />
 <button id="action-btn">Login</button>

<p class="toggle" id="toggle-text">
 Don't have an account? <span id="toggle-link">Sign up</span>
 </p>
 <p class="message" id="message"></p>
 </div>
 <script>
 const apiUrl = "https://i6te844sbj.execute-api.ap-south-1.amazonaws.com/deployment/authorization";
 let isLogin = true;
 const formTitle = document.getElementById("form-title");
 const emailInput = document.getElementById("email");
 const toggleText = document.getElementById("toggle-text");
 const toggleLink = document.getElementById("toggle-link");
 const actionBtn = document.getElementById("action-btn");
 const message = document.getElementById("message");
 function attachToggleListener() {
 document.getElementById("toggle-link").addEventListener("click", toggleForm);
 }
 function toggleForm() {
 isLogin = !isLogin;
 if (isLogin) {
 formTitle.textContent = "Login";
 emailInput.style.display = "none";
 actionBtn.textContent = "Login";
 toggleText.innerHTML = `Don't have an account? <span id="toggle-link">Sign up</span>`;
 } else {
 formTitle.textContent = "Sign Up";
 emailInput.style.display = "block";
 actionBtn.textContent = "Sign Up";
 toggleText.innerHTML = `Already have an account? <span id="toggle-link">Login</span>`;
 }
 attachToggleListener();
 message.textContent = "";
 }
 attachToggleListener();
 actionBtn.addEventListener("click", async () => {
 const username = document.getElementById("username").value.trim();
 const email = document.getElementById("email").value.trim();
 const password = document.getElementById("password").value.trim();
 if (!username || !password || (!isLogin && !email)) {
 message.textContent = "Please fill all required fields.";
 message.style.color = "red";
 return;
 }
 message.textContent = "Processing...";
 message.style.color = "black";
 try {
 const body = { action: isLogin ? "login" : "signup", username, email, password };
 const response = await fetch(apiUrl, {

method: "POST",
 headers: { "Content-Type": "application/json" },
 body: JSON.stringify(body)
 });
 const result = await response.json();
 let data = {};
 if (result.body) {
 try {
 data = JSON.parse(result.body);
 } catch {
 data = { message: result.body };
 }
 } else {
 data = result;
 }
 message.textContent = data.message || "No response from server";
 message.style.color = response.ok ? "green" : "red";
 // Store token in localStorage when login is successful
 if (isLogin && response.ok && data.token) {
 localStorage.setItem("authToken", data.token);
 console.log("Token saved:", data.token);
 // Redirect to dashboard or another page
 // window.location.href = `/dashboard?token=${data.token}`;
 window.location.href="/dashboard";
 } else if (!isLogin && response.ok) {
 isLogin = true;
 formTitle.textContent = "Login";
 emailInput.style.display = "none";
 actionBtn.textContent = "Login";
 toggleText.innerHTML = `Don't have an account? <span id="toggle-link">Sign up</span>`;
 attachToggleListener();
 message.textContent = "Signup successful! Please login.";
 message.style.color = "green";
 }
 } catch (err) {
 console.error(err);
 message.textContent = "Network error. Try again.";
 message.style.color = "red";
 }
 });
 </script>
</body>
</html>